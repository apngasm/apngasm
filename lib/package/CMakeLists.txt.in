cmake_minimum_required(VERSION 3.13)

project(libapngasm)

install(FILES @APNGASM_HEADERS@ DESTINATION include COMPONENT headers)
install(FILES @APNGASM_LIBRARIES@ DESTINATION lib COMPONENT libraries)

set(VERSION "@APNGASM_LIB_VERSION_MAJOR@.@APNGASM_LIB_VERSION_MINOR@-@APNGASM_LIB_VERSION_PATCH@")

include(InstallRequiredSystemLibraries)

set(CPACK_PACKAGE_VERSION_MAJOR "@APNGASM_LIB_VERSION_MAJOR@")
set(CPACK_PACKAGE_VERSION_MINOR "@APNGASM_LIB_VERSION_MINOR@")
set(CPACK_PACKAGE_VERSION_PATCH "@APNGASM_LIB_VERSION_PATCH@")
set(CPACK_PACKAGE_DESCRIPTION_SUMMARY "apngasm APNG Assembler libraries")
set(CPACK_PACKAGE_DESCRIPTION_FILE "@APNGASM_LIB_SOURCE_DIR@/DESCRIPTION.txt")
set(CPACK_RESOURCE_FILE_README "@APNGASM_LIB_SOURCE_DIR@/DESCRIPTION.txt")
set(CPACK_RESOURCE_FILE_LICENSE "@APNGASM_LIB_SOURCE_DIR@/LICENSE.txt")
set(CPACK_PACKAGE_VENDOR "apngasm")
set(CPACK_PACKAGE_CONTACT "zero@phantom.industries")
set(CPACK_PACKAGE_FILE_NAME "libapngasm_${VERSION}_${CMAKE_SYSTEM_PROCESSOR}")
set(CPACK_COMPONENTS libraries headers)

if (UNIX)
	set(CPACK_GENERATOR "DEB")
	set(CPACK_DEBIAN_PACKAGE_DEPENDS "libc6 (>= 2.28), libpng16-16 (>= 1.6.36), zlib1g (>= 1:1.2.11)")
endif ()
if (APPLE)
	set(CPACK_GENERATOR "productbuild")
	set(CPACK_PACKAGING_INSTALL_PREFIX ${CMAKE_INSTALL_PREFIX})
endif ()
if (WIN32)
	set(CPACK_GENERATOR "NSIS")
	set(CMAKE_INSTALL_PREFIX $ENV{SYSTEMDRIVE}/${PROJECT_NAME})
endif ()

include(CPack)
