cmake_minimum_required(VERSION 3.13)

project(apngasm)

install(PROGRAMS @APNGASM_BINARIES@ DESTINATION bin COMPONENT applications)

if (WIN32 AND NOT MINGW)
	install(FILES @APNGASM_LIBRARIES@ DESTINATION bin COMPONENT libraries)
endif ()

set(VERSION "@APNGASM_CLI_VERSION_MAJOR@.@APNGASM_CLI_VERSION_MINOR@-@APNGASM_CLI_VERSION_PATCH@")

include(InstallRequiredSystemLibraries)

set(CPACK_PACKAGE_VERSION_MAJOR "@APNGASM_CLI_VERSION_MAJOR@")
set(CPACK_PACKAGE_VERSION_MINOR "@APNGASM_CLI_VERSION_MINOR@")
set(CPACK_PACKAGE_VERSION_PATCH "@APNGASM_CLI_VERSION_PATCH@")
set(CPACK_PACKAGE_DESCRIPTION_SUMMARY "apngasm APNG Assembler command line tool")
set(CPACK_PACKAGE_DESCRIPTION_FILE "@APNGASM_CLI_SOURCE_DIR@/DESCRIPTION.txt")
set(CPACK_RESOURCE_FILE_README "@APNGASM_CLI_SOURCE_DIR@/DESCRIPTION.txt")
set(CPACK_RESOURCE_FILE_LICENSE "@APNGASM_CLI_SOURCE_DIR@/LICENSE.txt")
set(CPACK_PACKAGE_VENDOR "apngasm")
set(CPACK_PACKAGE_CONTACT "zero@phantom.industries")
set(CPACK_PACKAGE_FILE_NAME "apngasm_${VERSION}_${CMAKE_SYSTEM_PROCESSOR}")

if (WIN32 AND NOT MINGW)
	set(CPACK_COMPONENTS applications libraries)
else ()
	set(CPACK_COMPONENTS_ALL applications)
endif ()

if (UNIX)
	set(CPACK_GENERATOR "DEB")
	set(CPACK_DEBIAN_PACKAGE_DEPENDS "libapngasm (>= @APNGASM_LIB_VERSION@)")
endif ()
if(APPLE)
	set(CPACK_GENERATOR "productbuild")
	set(CPACK_PACKAGING_INSTALL_PREFIX ${CMAKE_INSTALL_PREFIX})
endif ()
if (WIN32)
	set(CPACK_PACKAGE_INSTALL_DIRECTORY "apngasm")
	set(CPACK_GENERATOR "NSIS")
	set(CPACK_NSIS_MODIFY_PATH "ON")
endif ()

include(CPack)
